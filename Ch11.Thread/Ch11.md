# Ch11 线程

## 11.1 线程概述

### 11.1.1 线程概念

1. 线程是什么

一个线程是指程序中单一顺序的控制流，一个进程中可以创建多个线程，实现并发运行，每个线程执行不同任务。

线程是参与系统调度的最小单位。被包含在进程之中，是进程中的实际运行单位。

2. 线程如何创建

当一个程序启动时，就有一个进程被操作系统（OS）创建，与此同时一个线程也立刻运行，该线程通常叫做程序的主线程（Main Thread），因为它是程序一开始时就运行的线程。

main()函数就是主线程的入口函数，main()函数所执行的任务就是主线程需要执行的任务。

主线程的重要性：
- 其它新的线程（也就是子线程）是由主线程创建的
- 主线程通常会在最后结束运行，执行各种清理工作，譬如回收各个子线程

3. 线程的特点

线程是程序最基本的运行单位，而进程不能运行，真正运行的是进程中的线程。进程仅仅是一个容器，它包含了线程运行所需的数据结构、环境变量等信息。

同一进程中的多个线程将共享该进程中的全部系统资源。同一进程中的多个线程有各自的调用栈（call stack，我们称为线程栈），自己的寄存器环境（register context）、自己的线程本地存储（thread-local storage）。

Sum：
- 线程不单独存在、而是包含在进程中。
- 线程是参与系统调度的基本单位。
- 可并发执行。
- 共享进程资源。

4. 线程 & 进程

多进程编程的劣势：
- 进程间切换开销大
- 进程间通信较为麻烦
多线程弥补：
- 同一进程的多个线程间切换开销比较小
- 同一进程的多个线程间通信容易
- 线程创建的速度远大于进程创建的速度
- 多线程在多核处理器上更有优势

### 11.1.2 并发和并行

## 11.2 线程ID

## 11.3 创建线程

## 11.4 终止线程

## 11.5 回收线程

## 11.6 取消线程

## 11.7 分离线程

## 11.8 注册线程清理处理函数

## 11.9 线程属性

## 11.10 线程安全

## 11.11 更多细节问题