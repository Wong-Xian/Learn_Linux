# 文件的时间属性

|字段|说明|
|:-:|:-:|
|st_atim|文件最后被访问的时间|
|st_mtim|文件内容最后被修改的时间|
|st_ctim|文件状态最后被改变的时间|

* <b>文件最后被访问的时间</b>：访问指的是读取文件内容，文件内容最后一次被读取的时间，譬如使用read()函数读取文件内容便会改变该时间属性；
* <b>文件内容最后被修改的时间</b>：文件内容发生改变，譬如使用 write()函数写入数据到文件中便会改变该时间属性；
* <b>文件状态最后被改变的时间</b>：状态更改指的是该文件的 inode 节点最后一次被修改的时间，譬如更改文件的访问权限、更改文件的用户 ID、用户组 ID、更改链接数等，但它们并没有更改文件的实际内容，也没有访问（读取）文件内容。

## 5.6.1 utime()和utimes()修改时间属性

这两个函数是系统调用。

只能显式修改文件的最后一次访问时间和文件内容最后被修改的时间，不能显式修改文件状态最后被改变的时间。

### utime函数

utime函数原型
``` c
#include <sys/types.h>
#include <utime.h>
int utime(const char *filename, const struct utimbuf *times);
```

<b>times:</b>将时间属性修改为该参数所指定的时间值。这是一个 struct utimbuf 结构体类型的指针。如果将 times 参数设置为 NULL，则会将文件的访问时间和修改时间设置为系统当前时间。

<b>返回值：</b>成功返回值 0；失败将返回-1，并会设置 errno。

struct utimbuf 结构体:
``` c
struct utimbuf
{
    time_t actime;  /* 访问时间 */
    time_t modtime; /* 内容修改时间 */
};
```

能对文件的时间属性进行修改的进程类型：
* 超级用户进程（以 root 身份运行的进程）。
* 有效用户 ID 与该文件用户 ID（文件所有者）相匹配的进程。
* 在参数 times 等于 NULL 的情况下，对文件拥有写权限的进程。

### utimes函数

系统调用

可以以微秒级精度来指定时间值。

函数原型
``` c
#include <sys/time.h>
int utimes(const char *filename, const struct timeval times[2]);
```

<b>返回值：</b>成功返回 0；失败返回-1，并且会设置 errno。

struct timeval结构体原型：
``` c
struct timeval
{
    long tv_sec;  /* 秒 */
    long tv_usec; /* 微秒 */
};
```

## 5.6.2 futimens() utimensat() 修改时间属性