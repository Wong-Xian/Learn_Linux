# 5.10 文件重命名

rename() 系统调用

- 可以对文件重命名
- 可以把文件移动至同一个文件系统的另一个目录下

函数原型：

``` c
#include <stdio.h>
int rename(const char *oldpath, const char *newpath);
```

调用 rename()会将现有的一个路径名 oldpath 重命名为 newpath 参数所指定的路径名。

rename()调用仅操作目录条目，而不移动文件数据（不改变文件 inode 编号、不移动文件数据块中存储的内容），重命名既不影响指向该文件的其它硬链接，也不影响已经打开该文件的进程（譬如，在重命名之前该文件已被其它进程打开了，而且还未被关闭）。

根据 oldpath、newpath 的不同，有以下不同的情况需要进行说明：
- 若 newpath 参数指定的文件或目录已经存在，则将其覆盖；
- 若 newpath 和 oldpath 指向同一个文件，则不发生变化（且调用成功）。
- rename()系统调用对其两个参数中的软链接均不进行解引用。如果 oldpath 是一个软链接，那么将重命名该软链接；如果 newpath 是一个软链接，则会将其移除、被覆盖。
- 如果 oldpath 指代文件，而非目录，那么就不能将 newpath 指定为一个目录的路径名。要想重命名一个文件到某一个目录下，newpath 必须包含新的文件名。
- 如果 oldpath 指代为一个目录，在这种情况下，newpath 要么不存在，要么必须指定为一个空目录。
- oldpath 和 newpath 所指代的文件必须位于同一文件系统。由前面的介绍，可以得出此结论！
- 不能对.（当前目录）和..（上一级目录）进行重命名。