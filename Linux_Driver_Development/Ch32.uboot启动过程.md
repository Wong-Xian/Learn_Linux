# uboot 启动过程的分析

## 分析链接脚本 uboot.lds
- 要先编译 uboot 才会在根目录下出现 u-boot.lds 文件
- _start 在文件 arch/arm/lib/vectors.S 中定义
- 看 u-boot.map 文件934行，镜像复制的起始地址是87800000
- 看回 uboot.lds 的 .text 段，先是 img_copy_start 段，然后到中断向量表，然后到 start.o 文件

## uboot 启动过程
- 一路跳转到 save_boot_params_ret: 首先获取处理器的工作模式
- 设置进入 SVC 模式
- 设置向量表重定位
- 调用函数 cpu_init_cp15、cpu_init_crit 和 _main
  - cpu_init_cp15 函数对 CP15 的寄存器做了一些配置
  - cpu_init_crit 函数调用了函数 lowlevel_init
    - 先设置 sp 指向 CONFIG_SYS_INIT_SP_ADDR